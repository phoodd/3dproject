const o=Object.create(null);o.open="0";o.close="1";o.ping="2";o.pong="3";o.message="4";o.upgrade="5";o.noop="6";const l=Object.create(null);Object.keys(o).forEach(e=>{l[o[e]]=e});const O={type:"error",data:"parser error"},E=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",w=typeof ArrayBuffer=="function",b=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,T=({type:e,data:r},n,t)=>E&&r instanceof Blob?n?t(r):h(r,t):w&&(r instanceof ArrayBuffer||b(r))?n?t(r):h(new Blob([r]),t):t(o[e]+(r||"")),h=(e,r)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];r("b"+(t||""))},n.readAsDataURL(e)};function p(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let a;function D(e,r){if(E&&e.data instanceof Blob)return e.data.arrayBuffer().then(p).then(r);if(w&&(e.data instanceof ArrayBuffer||b(e.data)))return r(p(e.data));T(e,!1,n=>{a||(a=new TextEncoder),r(a.encode(n))})}const g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<g.length;e++)u[g.charCodeAt(e)]=e;const U=e=>{let r=e.length*.75,n=e.length,t,f=0,s,c,i,A;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);const B=new ArrayBuffer(r),y=new Uint8Array(B);for(t=0;t<n;t+=4)s=u[e.charCodeAt(t)],c=u[e.charCodeAt(t+1)],i=u[e.charCodeAt(t+2)],A=u[e.charCodeAt(t+3)],y[f++]=s<<2|c>>4,y[f++]=(c&15)<<4|i>>2,y[f++]=(i&3)<<6|A&63;return B},m=typeof ArrayBuffer=="function",C=(e,r)=>{if(typeof e!="string")return{type:"message",data:P(e,r)};const n=e.charAt(0);return n==="b"?{type:"message",data:S(e.substring(1),r)}:l[n]?e.length>1?{type:l[n],data:e.substring(1)}:{type:l[n]}:O},S=(e,r)=>{if(m){const n=U(e);return P(n,r)}else return{base64:!0,data:e}},P=(e,r)=>{switch(r){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},R=String.fromCharCode(30),_=(e,r)=>{const n=e.length,t=new Array(n);let f=0;e.forEach((s,c)=>{T(s,!1,i=>{t[c]=i,++f===n&&r(t.join(R))})})},j=(e,r)=>{const n=e.split(R),t=[];for(let f=0;f<n.length;f++){const s=C(n[f],r);if(t.push(s),s.type==="error")break}return t};let d;function N(e,r,n){d||(d=new TextDecoder);const t=r||e[0]<48||e[0]>54;return C(t?e:d.decode(e),n)}const V=4;export{j as a,T as b,D as c,C as d,_ as e,N as f,V as p};
